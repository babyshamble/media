///<jscompress sourcefile="data.js" />
/***********************************
 * @author Robby
 * @version 1.6.4.2
 * @date 2015/04/01
 * @update 2015/06/06
 * @email libenchangedeyou@163.com
 ************************************/if("undefined"==typeof YX)var YX={};YX.Data=function(){if("undefinded"==typeof jQuery)throw"YMAPI depended on jquery!";var b=this;this.errorMsg="";this.ajaxTimers=[];this.ajaxTimeout=1E4;this.config=new YX.Data.Config(this);this.util=new YX.Data.Util(this);this.cache=new YX.Data.Cache(this);this.config.Init();if(!this.config.lid&&!this.config.tid)throw this.errorMsg="Initialize data failed\uff0cNo LID or TID!",this.errorMsg;if(this.config.lid&&!/^\d{1,}$/.test(this.config.lid+""))throw this.errorMsg="Initialize Data Failed\uff0cNo LID!",this.errorMsg;if(this.config.tid&&!/^\d{1,}$/.test(this.config.tid+""))throw this.errorMsg="Initialize Data Failed\uff0cNo TID!",this.errorMsg;this.RD=function(a,d,c,e){if(e&&b.cache.Get(e))c(b.cache.Get(e),"");else if("function"!=typeof c&&(c=function(){}),d||(d={}),!a)b.errorMsg="The url is invalid!",c(null,b.errorMsg);else if(!b.ajaxTimers[e])return b.ajaxTimers[e]=setTimeout(function(){clearTimeout(b.ajaxTimers[e]);b.ajaxTimers[e]=0;b.errorMsg="Error,The request is timeout!";c(null,b.errorMsg)},b.ajaxTimeout),$.ajax({async:!0,url:a,type:"GET",dataType:"jsonp",jsonp:"yxjn",data:d,timeout:b.ajaxTimeout,cKey:e,success:function(a){b.ajaxTimers[e]&&(clearTimeout(b.ajaxTimers[e]),b.ajaxTimers[this.cKey]=0,a?(b.cache.Set(e,a),c(a,"")):(b.errorMsg="Data load failed!",c(null,b.errorMsg)))}}),!0};this.Site=function(a,d){b.RD(b.config.siteUrl+(d?d:b.config.siteRouter),{tid:b.config.tid,lid:b.config.lid},a,"site_"+b.config.lid+"_"+b.config.tid)};this.Map=function(a,d,c){a&&(b.config.sid=a);if(!/^\d{1,}$/.test(b.config.sid+""))throw b.errorMsg="Load Map's Data Failed\uff0cNo SID!",b.errorMsg;b.RD(b.config.mapUrl+(c?c:b.config.mapRouter),{sid:b.config.sid},d,"map_"+b.config.sid)};this.Hot=function(a,d,c){a||(a=b.config.sid);b.RD(b.config.hotUrl+(c?c:b.config.hotRouter),{sid:a},d,"Hot_"+a)};this.List=function(a,d,c,e,f,g){c||(c="");e||(e="");f||(f=b.config.sid);b.RD(b.config.listUrl+(g?g:b.config.listRouter),{sid:f,mid:a,pno:c,pco:e},d,"list_"+f+"_"+a+"_"+c+"_"+e)};this.Art=function(a,d,c){b.RD(b.config.artUrl+(c?c:b.config.artRouter),{aid:a},d,"art_"+a)};this.Cate=function(a,d,c,e){a||(a=b.config.lid);d||(d=b.config.tid);b.RD(b.config.cateUrl+(e?e:b.config.cateRouter),{lid:a,tid:d},c,"cate_"+a+"_"+d)};this.More=function(a,d,c,e,f,g){c||(c="");e||(e="");f||(f=b.config.sid);b.RD(b.config.moreUrl+(g?g:b.config.moreRouter),{sid:f,cid:a,pno:c,pco:e},d,"more_"+f+"_"+a+"_"+c+"_"+e)};this.SetTimeout=function(a){a&&(a+="",(!1,test(a+""))||(a=parseInt(a),b.ajaxTimeout=a))};this.StopAllRequest=function(){for(var a in this.ajaxTimers)clearTimeout(b.ajaxTimers[a]),b.ajaxTimers[a]=0;b.ajaxTimers=[]}};YX.Data.Config=function(b){var a=this;this.lid=this.sid=this.moreRouter=this.moreUrl=this.cateRouter=this.cateUrl=this.artRouter=this.artUrl=this.listRouter=this.listUrl=this.hotRouter=this.hotUrl=this.mapRouter=this.mapUrl=this.siteRouter=this.siteUrl=this.serverPath="";this;tid="";this.HttpPath=function(d){return a.GetDomain()+a.serverPath+d};this.GetDomain=function(){return document.location.href.split(a.serverPath)[0]};this.Init=function(){var d=location.pathname.split("/");a.serverPath=(3>d.length?"":d[d.length-2])+"/";a.siteUrl=0<$("#yx_siteurl").length?$("#yx_siteurl").get(0).href:"";a.siteRouter=0<$("#yx_siteurl").length?$("#yx_siteurl").get(0).getAttribute("router"):"";a.mapUrl=0<$("#yx_mapurl").length?$("#yx_mapurl").get(0).href:"";a.mapRouter=0<$("#yx_mapurl").length?$("#yx_mapurl").get(0).getAttribute("router"):"";a.hotUrl=0<$("#yx_hoturl").length?$("#yx_hoturl").get(0).href:"";a.hotRouter=0<$("#yx_hoturl").length?$("#yx_hoturl").get(0).getAttribute("router"):"";a.listUrl=0<$("#yx_listurl").length?$("#yx_listurl").get(0).href:"";a.listRouter=0<$("#yx_listurl").length?$("#yx_listurl").get(0).getAttribute("router"):"";a.cateUrl=0<$("#yx_cateurl").length?$("#yx_cateurl").get(0).href:"";a.cateRouter=0<$("#yx_cateurl").length?$("#yx_cateurl").get(0).getAttribute("router"):"";a.moreUrl=0<$("#yx_moreurl").length?$("#yx_moreurl").get(0).href:"";a.moreRouter=0<$("#yx_moreurl").length?$("#yx_moreurl").get(0).getAttribute("router"):"";a.artUrl=0<$("#yx_arturl").length?$("#yx_arturl").get(0).href:"";a.artRouter=0<$("#yx_arturl").length?$("#yx_arturl").get(0).getAttribute("router"):"";a.sid=0<$("#yx_sid").length?$("#yx_sid").text():"";a.tid=0<$("#yx_tid").length?$("#yx_tid").text():"";a.lid=0<$("#yx_lid").length?$("#yx_lid").text():""}};YX.Data.Cache=function(b){var a=this;this.IsCache=!1;this.Clear=function(){a.Memory.Clear();a.Local.Clear()};this.Get=function(d){if(!a.IsCache)return null;var b=a.Local.Get(d);return b?b:a.Memory.Get(d)};this.Set=function(d,b){a.IsCache&&(a.Memory.Set(d,b),a.Local.Set(d,b))};this.Memory={cache:{},Set:function(a,b){this.cache[a]=b},Get:function(a){return this.cache[a]?this.cache[a]:null},Clear:function(){this.cache={}}};this.Local={Get:function(a){if((a=window.localStorage&&window.localStorage.getItem(a)?window.localStorage.getItem(a):null)&&window.JSON)try{a=JSON.parse(a)}catch(b){}return a},Set:function(a,b){window.JSON&&"object"==typeof b&&(b=JSON.stringify(b));window.localStorage&&window.localStorage.setItem(a,b)},Clear:function(){window.localStorage&&window.localStorage.clear()}}};YX.Data.Util=function(b){this.DecodeUrl=function(a){return a?unescape(a):""};this.EncodeUrl=function(a){return a?escape(a):""};this.Serialize=function(a){switch(a.constructor){case Object:var b="{",c;for(c in a)b+=c+":"+this.Serialize(a[c])+",";","==b.substr(b.length-1)&&(b=b.substr(0,b.length-1));return b+"}";case Array:b="[";for(c in a)b+=this.Serialize(a[c])+",";","==b.substr(b.length-1)&&(b=b.substr(0,b.length-1));return b+"]";case Boolean:return'"'+a.toString()+'"';case Date:return'"'+a.toString()+'"';case Number:return'"'+a.toString()+'"';case String:return'"'+a.toString()+'"'}}};